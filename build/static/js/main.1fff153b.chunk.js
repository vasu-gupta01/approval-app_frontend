(this["webpackJsonpfill-a-form"]=this["webpackJsonpfill-a-form"]||[]).push([[0],{109:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(13),l=a.n(i),r=(a(59),a(18)),c=a(19),d=a(14),o=a(29),m=a(28),h=a(17),j=a(6),b=a(15),u=a.n(b),f=(a(33),function(){return u()({method:"GET",headers:{"Content-Type":"application/json"},url:"/api/getforms"})}),p=function(){return u()({method:"GET",headers:{"Content-Type":"application/json"},url:"/api/getapprovers"})},v=(a(24),a(47),a(3));var x=function(e){var t=e.dbForms,a=Object(j.g)();return Object(v.jsx)("div",{className:"container-form-selection",children:t&&0===t.length?Object(v.jsx)("div",{className:"d-flex justify-content-center text-center text-light",children:Object(v.jsxs)("div",{className:"row",children:[Object(v.jsx)("div",{className:"col-12 mb-2",children:Object(v.jsx)("div",{className:"spinner-border",role:"status",children:Object(v.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}),Object(v.jsx)("div",{className:"col-12",children:Object(v.jsx)("strong",{className:"",children:"Loading..."})})]})}):Object(v.jsxs)("form",{className:"card bg-light bg-gradient",children:[Object(v.jsxs)("div",{className:"card-body",children:[Object(v.jsx)("h5",{className:"card-title mb-3",children:"Please select a form"}),Object(v.jsxs)("select",{value:e.id,className:"form-select mb-3",onChange:function(t){e.onMakeSelection(t.target.value)},children:[Object(v.jsx)("option",{value:"-1",children:"-- select a form --"}),t.map((function(e){return Object(v.jsx)("option",{value:e._id,children:e.name},e._id)}))]})]}),Object(v.jsx)("div",{className:"card-footer text-end",children:Object(v.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:function(){"-1"!==e.id&&a.push("/form")},children:"Confirm"})})]})})},O=a(23),g=new(function(){function e(){Object(r.a)(this,e)}return Object(c.a)(e,[{key:"getForm",value:function(e){return u.a.post("/api/getform",e)}},{key:"getDepartments",value:function(){return u.a.get("/api/getdepartments")}}]),e}()),y=a.p+"static/media/Beta-HealthcareLG-Trebuchet-MS-font.4688ae12.png",N=a(54),_=a(20);var F=function(e){var t=s.a.useState(!1),a=Object(N.a)(t,2),i=a[0],l=a[1],r=e.success;return Object(n.useEffect)((function(){l(e.show)}),[e.show]),r?Object(v.jsx)(_.a,{show:i,dialogClassName:"modal-dialog-centered",children:Object(v.jsxs)("div",{className:"",children:[Object(v.jsx)(_.a.Header,{children:Object(v.jsx)(_.a.Title,{className:"text-success bg-gradient",children:"Success!"})}),Object(v.jsx)(_.a.Body,{children:"Your approval request has been submitted."}),Object(v.jsx)(_.a.Footer,{as:"footer",children:Object(v.jsx)(h.b,{className:"btn btn-outline-dark",to:"/",children:"Go to homepage"})})]})}):Object(v.jsxs)("div",{className:"container container-form alert alert-danger",role:"alert",children:[Object(v.jsx)("h5",{className:"alert-heading",children:"Submission failed"}),Object(v.jsx)("hr",{}),Object(v.jsxs)("p",{className:"mb-0",children:[Object(v.jsx)(h.b,{className:"btn btn-primary",to:"/",children:"Click here"})," ","to fill another form"]})]})},C=(a(85),a(53)),k=a.n(C),S=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e))._isMounted=!1,n.sendForm=function(e){if(e.preventDefault(),n.validateForm()){var t,a=n.state.checkedApprovers,s=[],i=Object(O.a)(a.keys());try{for(i.s();!(t=i.n()).done;){var l=t.value;!0===a.get(l)&&s.push(l)}}catch(d){i.e(d)}finally{i.f()}var r={filled_by:n.state.filled_by,form_id:n.state.formID,form_title:n.state.name,fields:n.state.formFields,approved:!1,date_approved:null,approval:n.state.approvers,department:n.state.department},c=!1;r.fields?u.a.post("/api/sendform",r).then().catch((function(e){c=!0,console.log(e)})):console.log("input fields are required"),c||n.setState({done:!0})}},n.handleChange=function(e,t){var a,s=n.state.formFields,i=Object(O.a)(s);try{for(i.s();!(a=i.n()).done;){var l=a.value;l._id===t&&(l.value=e)}}catch(r){i.e(r)}finally{i.f()}n.setState({formFields:s})},n.handleNameChange=function(e){n.setState({filled_by:e})},n.handleDeptChange=function(e){var t,a=n.state.formFields,s=Object(O.a)(a);try{for(s.s();!(t=s.n()).done;){var i=t.value;"Department"===i.name&&(i.value=e)}}catch(l){s.e(l)}finally{s.f()}n.setState({department:e}),n.setState({formFields:a})},n.state={name:"",formID:"",filled_by:"",department:"",formFields:[],formData:{},done:!1,approvers:[],checkedApprovers:new Map,approversValid:!1,timeout:null,validMessages:{name:"Error"},validFields:{name:!0},departments:[]},n.handleChange=n.handleChange.bind(Object(d.a)(n)),n.sendForm=n.sendForm.bind(Object(d.a)(n)),n.handleNameChange=n.handleNameChange.bind(Object(d.a)(n)),n.fieldsGenerator=n.fieldsGenerator.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;this.props.dbForms;var t={},a="",n=[],s=this.props.id;s&&this._isMounted&&(this.setState({formID:s}),g.getForm({id:this.props.id}).then((function(s){a=s.data.name,n=s.data.fields,e.setState({name:a,filled_by:"",formFields:n,formData:t});for(var i=0;i<n.length;i++)t[n[i].name]="",n[i].value=""}))),p().then((function(t){t.data&&e._isMounted&&e.setState({approvers:t.data})})),g.getDepartments().then((function(t){t.data&&e._isMounted&&e.setState({departments:t.data})}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"fieldsGenerator",value:function(e){var t=this;return e?e.map((function(e){if(!e.type)return Object(v.jsxs)("div",{className:"form-floating mb-3",children:[Object(v.jsx)("input",{type:"text",autoComplete:"off",className:"form-control",id:"floatingInput",placeholder:e.name,onChange:function(a){return t.handleChange(a.target.value,e._id)}},e._id),Object(v.jsx)("label",{htmlFor:"floatingInput",className:"text-muted",children:e.name},"label_"+e._id),Object(v.jsx)("div",{style:{display:t.state.validFields[e._id]?"none":"block"},children:Object(v.jsx)("strong",{className:"text-danger m-1",children:t.state.validMessages[e._id]})})]},"div_"+e._id);switch(e.type.name){case"select":return Object(v.jsxs)("div",{className:"form-floating mb-3",children:[Object(v.jsxs)("select",{className:"form-select",id:"floatingSelect","aria-label":"Floating label",onChange:function(e){return t.handleDeptChange(e.target.value)},children:[Object(v.jsx)("option",{selected:!0,value:"",children:"-- department --"}),t.state.departments.map((function(e){return Object(v.jsx)("option",{value:e.name,children:e.name},"key_"+e._id)}))]}),Object(v.jsx)("label",{htmlFor:"floatingSelect",className:"text-muted",children:e.name},"label_"+e._id),Object(v.jsx)("div",{style:{display:t.state.validFields[e._id]?"none":"block"},children:Object(v.jsx)("strong",{className:"text-danger m-1",children:t.state.validMessages[e._id]})})]},"div_"+e._id);case"time":return Object(v.jsxs)("div",{className:" mb-3",children:[Object(v.jsxs)("label",{className:"me-3",children:[e.name,": "]}),Object(v.jsx)(k.a,{disableClock:!0,value:t.state.timeout,onChange:function(a){t.setState({timeout:a}),t.handleChange(a,e._id)}}),Object(v.jsx)("div",{style:{display:t.state.validFields[e._id]?"none":"block"},children:Object(v.jsx)("strong",{className:"text-danger m-1",children:t.state.validMessages[e._id]})})]},"div_"+e._id);default:return Object(v.jsxs)("div",{className:"form-floating mb-3",children:[Object(v.jsx)("input",{type:"text",autoComplete:"off",className:"form-control",id:"floatingInput",placeholder:e.name,onChange:function(a){return t.handleChange(a.target.value,e._id)}},e._id),Object(v.jsx)("label",{htmlFor:"floatingInput",className:"text-muted",children:e.name},"label_"+e._id),Object(v.jsx)("div",{style:{display:t.state.validFields[e._id]?"none":"block"},children:Object(v.jsx)("strong",{className:"text-danger m-1",children:t.state.validMessages[e._id]})})]},"div_"+e._id)}})):Object(v.jsx)("div",{children:"No DATA"})}},{key:"validateForm",value:function(){var e=this.state.validMessages,t=this.state.validFields,a=!0;""===this.state.filled_by?(t.name=!1,e.name="This field is required.",a=!1):t.name=!0;var n,s=Object(O.a)(this.state.formFields);try{for(s.s();!(n=s.n()).done;){var i=n.value;i.required&&""===i.value?(t[i._id]=!1,e[i._id]="This field is required.",a=!1):t[i._id]=!0}}catch(l){s.e(l)}finally{s.f()}return this.setState({validMessages:e,validFields:t}),a}},{key:"render",value:function(){var e=this;if("-1"===this.props.id)return Object(v.jsx)(j.a,{to:"/"});var t=this.state.formFields;this.state.approvers;return Object(v.jsx)("div",{className:"container-form",children:Object(v.jsxs)("form",{className:"card bg-light bg-gradient",autoComplete:"off",children:[Object(v.jsx)("div",{className:"row card-body",children:Object(v.jsx)("img",{src:y,className:"img-fluid",alt:"logo"})}),Object(v.jsxs)("div",{className:"card-body",children:[Object(v.jsxs)("h2",{className:"card-title mb-4 text-center",children:[this.state.name," form"]}),Object(v.jsxs)("div",{className:"form-floating mb-3",children:[Object(v.jsx)("input",{type:"text",autoComplete:"off",className:"form-control",id:"floatingInput",placeholder:"Employee Name",onChange:function(t){e.handleNameChange(t.target.value)}}),Object(v.jsx)("label",{className:"text-muted",htmlFor:"floatingInput",children:"Employee Name"}),Object(v.jsx)("div",{style:{display:this.state.validFields.name?"none":"block"},children:Object(v.jsx)("strong",{className:"text-danger m-1",children:this.state.validMessages.name})})]}),this.fieldsGenerator(t)]}),Object(v.jsx)("div",{className:"card-body"}),Object(v.jsx)("div",{className:"card-footer text-end",children:Object(v.jsx)("button",{className:"btn btn-outline-primary",type:"button",onClick:this.sendForm,children:"Submit"})}),Object(v.jsx)(F,{success:!0,show:this.state.done})]})})}}]),a}(n.Component),M=function(e){Object(o.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={selectedFormID:"-1",dbForms:[]},n.handleFormSelect=n.handleFormSelect.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;f().then((function(t){t.data&&e.setState({dbForms:t.data})}))}},{key:"handleFormSelect",value:function(e){this.setState({selectedFormID:e})}},{key:"render",value:function(){var e=this,t=this.state.selectedFormID,a=this.state.dbForms;return Object(v.jsx)(h.a,{children:Object(v.jsx)("div",{className:"App-Container container d-flex align-items-center justify-content-center",children:Object(v.jsxs)(j.d,{children:[Object(v.jsx)(j.b,{path:"/",component:function(){return Object(v.jsx)(x,{id:t,dbForms:a,onMakeSelection:e.handleFormSelect})},exact:!0}),Object(v.jsx)(j.b,{path:"/form",component:function(){return Object(v.jsx)(S,{id:t,dbForms:a})},exact:!0})]})})})}}]),a}(n.Component);l.a.render(Object(v.jsx)(M,{}),document.getElementById("root"))},33:function(e,t){e.exports={ADDR:"http://localhost"}},47:function(e,t,a){},59:function(e,t,a){}},[[109,1,2]]]);
//# sourceMappingURL=main.1fff153b.chunk.js.map